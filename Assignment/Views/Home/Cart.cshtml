@using System.Diagnostics.Eventing.Reader
<div>
    <h1 class="text-center">Giỏ hàng</h1>

    <div class="row mt-3">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th scope="col">Tên sản phẩm</th>
                <th scope="col">Giá bán</th>
                <th scope="col">Số lượng</th>
                <th scope="col">Tổng tiền</th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tbody id="CartData"></tbody>
        </table>
    </div>
    <div id="buyAll"></div>
</div>

<div>
    <div class="modal fade" id="buyModal" tabindex="-1" aria-labelledby="buyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="buyModalLabel">Mua ngay</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    @if (User.Identity != null && User.Identity.IsAuthenticated)
                    {
                        <div class="mb-3 row">
                            <h1 class="h1">Thông tin người nhận</h1>
                            <div class="mb-3">
                                <label for="name" class="form-label">Tên người nhận</label>
                                <input type="text" class="form-control" id="name" placeholder="ví dụ: Bùi Đăng Khoa" value="@User.Identity.Name">
                            </div>
                            <div class="mb-3">
                                <label for="phone" class="form-label">Số điện thoại người nhận</label>
                                <input type="text" class="form-control" id="phone" placeholder="ví dụ: 0999999999">
                            </div>
                            <div class="mb-3">
                                <label for="email" class="form-label">Địa chỉ email người nhận (Tùy chọn)</label>
                                <input type="email" class="form-control" id="email" placeholder="ví dụ: khoabdtb00417@fpt.edu.vn">
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <h1 class="h1">Thông tin sản phẩm</h1>
                            <div class="mb-3">
                                <label for="productName" class="form-label">Tên sản phẩm</label>
                                <input type="text" class="form-control" id="productName" readonly="">
                            </div>
                            <div class="mb-3">
                                <label for="productQuantity" class="form-label">Số lượng sản phẩm</label>
                                <input type="number" class="form-control" id="productQuantity" placeholder="ví dụ: 999" value="1">
                            </div>
                            <div class="mb-3">
                                <label for="productPrice" class="form-label">Tổng hóa đơn</label>
                                <input type="text" class="form-control" id="productPrice" readonly="">
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning" role="alert">
                            Bạn cần đăng nhập để thực hiện thanh toán. Vui lòng <a href="/login">đăng nhập</a> hoặc <a href="/register">đăng ký tài khoản</a>.
                        </div>
                    }
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    @if (User.Identity != null && User.Identity.IsAuthenticated)
                    {
                        <button type="button" class="btn btn-success" onclick="buyNow()">Thanh toán</button>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="buyAllModal" tabindex="-1" aria-labelledby="buyAllModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="buyAllModalLabel">Mua ngay</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    @if (User.Identity != null && User.Identity.IsAuthenticated)
                    {
                        <div class="mb-3 row">
                            <h1 class="h1">Thông tin người nhận</h1>
                            <div class="mb-3">
                                <label for="buyall_name" class="form-label">Tên người nhận</label>
                                <input type="text" class="form-control" id="buyall_name" placeholder="ví dụ: Bùi Đăng Khoa" value="@User.Identity.Name">
                            </div>
                            <div class="mb-3">
                                <label for="buyall_phone" class="form-label">Số điện thoại người nhận</label>
                                <input type="text" class="form-control" id="buyall_phone" placeholder="ví dụ: 0999999999">
                            </div>
                            <div class="mb-3">
                                <label for="buyall_email" class="form-label">Địa chỉ email người nhận (Tùy chọn)</label>
                                <input type="email" class="form-control" id="buyall_email" placeholder="ví dụ: khoabdtb00417@fpt.edu.vn">
                            </div>
                        </div>
@*                         <div class="mb-3 row">
                            <h1 class="h1">Thông tin sản phẩm</h1>
                            <div class="mb-3">
                                <label for="productPrice" class="form-label">Tổng hóa đơn</label>
                                <input type="text" class="form-control" id="productPrice" readonly="">
                            </div>
                        </div> *@
                    }
                    else
                    {
                        <div class="alert alert-warning" role="alert">
                            Bạn cần đăng nhập để thực hiện thanh toán. Vui lòng <a href="/login">đăng nhập</a> hoặc <a href="/register">đăng ký tài khoản</a>.
                        </div>
                    }
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    @if (User.Identity != null && User.Identity.IsAuthenticated)
                    {
                        <button type="button" class="btn btn-success" onclick="buyAll()">Thanh toán</button>
                    }
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="deleteModalLabel">Xóa khỏi giỏ hàng</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Bạn có chắc chắn muốn xóa sản phẩm này khỏi giỏ hàng?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-danger" onclick="del()">Xóa sản phẩm</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/js/cart.js"></script>
